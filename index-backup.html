<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GiveFi - Transparent Giveaways on Solana</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Solana Web3.js -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <script src="https://unpkg.com/bn.js@5.2.1/lib/bn.min.js"></script>
    
    <style>
        :root {
            --glass-bg: rgba(15, 15, 23, 0.75);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-hover: rgba(20, 241, 149, 0.05);
            --primary-green: #14f195;
            --primary-purple: #9945ff;
            --accent-blue: #00d2ff;
            --dark-bg: #0a0a0f;
            --dark-card: #131321;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b8;
            --text-muted: #6c6c89;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Glass Dark Background with Mesh Gradient */
        .mesh-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(20, 241, 149, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(153, 69, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 210, 255, 0.08) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #131321 50%, #1a1a2e 100%);
            z-index: -2;
        }

        /* Animated particles overlay */
        .particles-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.3;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--primary-green);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.8; }
        }

        /* Advertisement Banner */
        .ad-banner-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.15), rgba(153, 69, 255, 0.15));
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1001;
            overflow: hidden;
        }

        .ad-banner {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0 2rem;
            position: relative;
        }

        .ad-banner:hover {
            background: rgba(20, 241, 149, 0.1);
        }

        .ad-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .ad-logo {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: cover;
        }

        .ad-text {
            flex: 1;
            min-width: 0;
        }

        .ad-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ad-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ad-sponsored {
            background: rgba(20, 241, 149, 0.2);
            color: var(--primary-green);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid rgba(20, 241, 149, 0.3);
        }

        .ad-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 2px;
            background: var(--primary-green);
            transition: width 0.1s linear;
        }

        .ad-controls {
            position: absolute;
            top: 50%;
            right: 1rem;
            transform: translateY(-50%);
            display: flex;
            gap: 6px;
        }

        .ad-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ad-dot.active {
            background: var(--primary-green);
            transform: scale(1.2);
        }

        /* Glass Header */
        .glass-header {
            position: fixed;
            top: 60px; /* Offset for ad banner */
            left: 0;
            right: 0;
            height: 80px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            transition: all 0.3s ease;
        }

        .glass-header.scrolled {
            height: 70px;
            background: rgba(15, 15, 23, 0.9);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            box-shadow: 0 4px 20px rgba(20, 241, 149, 0.3);
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary-green);
            background: var(--glass-hover);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: var(--primary-green);
            border-radius: 50%;
        }

        /* Wallet Connection Button */
        .wallet-connect {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .wallet-connect:hover {
            background: var(--glass-hover);
            border-color: var(--primary-green);
            box-shadow: 0 4px 20px rgba(20, 241, 149, 0.2);
        }

        .wallet-connect.connected {
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            border-color: transparent;
            color: white;
        }

        /* Main Content Container */
        .main-container {
            margin-top: 160px; /* Header (80px) + Ad Banner (80px) */
            min-height: calc(100vh - 160px);
            padding: 2rem;
        }

        /* Marketplace Layout Styles */
        .marketplace-grid {
            display: grid;
            grid-template-columns: 250px 1fr 320px;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (max-width: 1024px) {
            .marketplace-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        /* Glass Card Base */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            border-color: rgba(20, 241, 149, 0.3);
            box-shadow: 0 8px 32px rgba(20, 241, 149, 0.1);
        }

        /* Sidebar Filters */
        .sidebar {
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .filter-section {
            margin-bottom: 2rem;
        }

        .filter-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-option:hover {
            background: var(--glass-hover);
            border-color: var(--primary-green);
        }

        .filter-option.active {
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.1), rgba(153, 69, 255, 0.1));
            border: 1px solid var(--primary-green);
        }

        /* Main Content Area */
        .main-content {
            overflow: hidden;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-green), var(--primary-purple));
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-green);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .stat-change {
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .stat-change.positive {
            color: var(--primary-green);
        }

        .stat-change.negative {
            color: #ff6b7a;
        }

        /* Raffle Cards Grid */
        .raffles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .raffle-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .raffle-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary-green);
            box-shadow: 0 12px 40px rgba(20, 241, 149, 0.15);
        }

        .raffle-card.featured {
            border: 2px solid var(--primary-green);
            box-shadow: 0 8px 32px rgba(20, 241, 149, 0.2);
        }

        .raffle-card.featured::before {
            content: '🔥 FEATURED';
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            z-index: 2;
        }

        .raffle-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            position: relative;
        }

        .raffle-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.7) 100%);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 1rem;
        }

        .raffle-status {
            position: absolute;
            top: 12px;
            left: 12px;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .raffle-status.live {
            background: rgba(20, 241, 149, 0.9);
            color: white;
        }

        .raffle-status.ending {
            background: rgba(255, 107, 122, 0.9);
            color: white;
        }

        .raffle-status.ended {
            background: rgba(108, 108, 137, 0.9);
            color: white;
        }

        .raffle-content {
            padding: 1.5rem;
        }

        .raffle-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .raffle-price {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .raffle-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .raffle-stat {
            text-align: center;
        }

        .raffle-stat-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-green);
        }

        .raffle-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .raffle-progress {
            margin-bottom: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-green), var(--primary-purple));
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .raffle-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-primary {
            flex: 1;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            border: none;
            border-radius: 10px;
            padding: 0.875rem 1.5rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(20, 241, 149, 0.3);
        }

        .btn-secondary {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 0.875rem 1rem;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        /* Right Sidebar - Live Data */
        .right-sidebar {
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .live-data-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .live-data-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-green);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .pulse-dot {
            width: 8px;
            height: 8px;
            background: var(--primary-green);
            border-radius: 50%;
            animation: pulseScale 2s infinite;
        }

        @keyframes pulseScale {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            border-left: 3px solid var(--primary-green);
        }

        .activity-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-purple));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .activity-time {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Trending Section */
        .trending-card {
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.05), rgba(153, 69, 255, 0.05));
            border: 1px solid rgba(20, 241, 149, 0.2);
        }

        .trending-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .trending-item:hover {
            background: var(--glass-hover);
            transform: translateX(4px);
        }

        .trending-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .trending-rank {
            width: 24px;
            height: 24px;
            background: var(--primary-green);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .trending-details h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .trending-details p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .trending-value {
            text-align: right;
        }

        .trending-price {
            font-weight: 700;
            color: var(--primary-green);
        }

        .trending-change {
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        /* Loading States */
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Right Sidebar Styles */
        .right-sidebar {
            padding: 0 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: 100px;
        }

        .live-data-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .live-data-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--primary-green);
            font-weight: 600;
        }

        .pulse-dot {
            width: 8px;
            height: 8px;
            background: var(--primary-green);
            border-radius: 50%;
            animation: pulseGlow 2s infinite;
        }

        @keyframes pulseGlow {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        .activity-feed {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .activity-icon {
            font-size: 1.2rem;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(20, 241, 149, 0.1);
            border-radius: 8px;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .activity-time {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .trending-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .trending-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .trending-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .trending-rank {
            width: 24px;
            height: 24px;
            background: var(--primary-green);
            color: #000;
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .trending-details h4 {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
        }

        .trending-details p {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin: 0;
        }

        .trending-value {
            text-align: right;
        }

        .trending-price {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .trending-change {
            font-size: 0.8rem;
            font-weight: 500;
        }

        .trending-change.positive {
            color: var(--primary-green);
        }

        .trending-change.negative {
            color: #ff6b6b;
        }

        .stat-value {
            color: var(--text-primary);
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        .stat-change {
            font-size: 0.8rem;
            font-weight: 500;
        }

        .stat-change.positive {
            color: var(--primary-green);
        }

        .stat-change.negative {
            color: #ff6b6b;
        }

        /* Responsive Design - Enhanced Mobile Support */
        @media (max-width: 1200px) {
            .marketplace-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 0 15px;
            }
            
            .left-sidebar,
            .right-sidebar {
                display: none;
            }
            
            .main-content {
                padding: 0;
            }

            .raffle-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 15px;
            }
        }

        @media (max-width: 768px) {
            /* Mobile Ad Banner */
            .ad-banner-container {
                height: 50px;
            }

            .ad-banner {
                padding: 0 1rem;
            }

            .ad-logo {
                width: 32px;
                height: 32px;
            }

            .ad-title {
                font-size: 0.9rem;
            }

            .ad-description {
                font-size: 0.75rem;
            }

            .ad-sponsored {
                font-size: 0.7rem;
                padding: 3px 6px;
            }

            .ad-controls {
                right: 0.5rem;
            }

            .ad-dot {
                width: 6px;
                height: 6px;
            }

            /* Mobile Header */
            .glass-header {
                top: 50px; /* Adjusted for smaller ad banner */
                height: 70px;
                padding: 0 1rem;
                flex-wrap: wrap;
            }

            .logo-section {
                gap: 0.5rem;
            }

            .logo-icon {
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
            }

            .logo-text {
                font-size: 1.3rem;
            }

            .nav-links {
                display: none; /* Hide navigation on mobile */
            }

            .wallet-connect {
                padding: 8px 16px;
                font-size: 0.9rem;
            }

            .wallet-connect span {
                display: none; /* Only show icon on mobile */
            }

            /* Mobile Marketplace */
            .marketplace-container {
                margin-top: 120px; /* Account for mobile ad banner + header */
                padding: 0 1rem;
            }

            .main-header {
                padding: 0 1rem;
                height: auto;
                min-height: 70px;
                flex-direction: column;
                gap: 1rem;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
                width: 100%;
            }

            .search-container {
                width: 100%;
                max-width: none;
            }

            .search-input {
                width: 100%;
                font-size: 16px; /* Prevent zoom on iOS */
                padding: 12px 20px;
            }

            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
                gap: 10px;
            }

            .action-btn {
                padding: 10px 16px;
                font-size: 0.9rem;
                min-width: 120px;
                white-space: nowrap;
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin-bottom: 20px;
            }

            .stat-card {
                padding: 12px;
                min-height: 80px;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            .stat-label {
                font-size: 0.75rem;
                line-height: 1.2;
            }

            /* Mobile Raffle Cards */
            .raffle-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .raffle-card {
                max-width: none;
                margin: 0;
            }

            .raffle-image {
                height: 200px;
            }

            .raffle-content {
                padding: 15px;
            }

            .raffle-title {
                font-size: 1.1rem;
                line-height: 1.3;
            }

            .raffle-meta {
                flex-wrap: wrap;
                gap: 8px;
            }

            .meta-item {
                font-size: 0.8rem;
            }

            .raffle-stats {
                margin: 15px 0;
            }

            .progress-info {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }

            .countdown {
                flex-wrap: wrap;
                gap: 8px;
                justify-content: center;
            }

            .countdown-item {
                min-width: 60px;
            }

            .raffle-actions {
                flex-direction: column;
                gap: 10px;
            }

            .enter-btn,
            .view-btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            /* Extra small mobile devices */
            .marketplace-container {
                padding: 0 0.5rem;
            }

            .raffle-card {
                border-radius: 12px;
            }

            .raffle-content {
                padding: 12px;
            }

            .raffle-title {
                font-size: 1rem;
            }

            .stats-bar {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .stat-card {
                padding: 10px;
                min-height: 70px;
                text-align: center;
            }

            .countdown {
                gap: 6px;
            }

            .countdown-item {
                min-width: 50px;
                padding: 8px 4px;
            }

            .countdown-value {
                font-size: 1rem;
            }

            .countdown-label {
                font-size: 0.7rem;
            }

            /* Prevent horizontal scrolling */
            body {
                overflow-x: hidden;
            }

            .glass-header,
            .ad-banner-container {
                padding: 0 0.5rem;
            }
        }

            .raffle-title {
                font-size: 1.1rem;
            }

            .raffle-stats {
                grid-template-columns: 1fr 1fr;
            }

            .raffle-actions {
                flex-direction: column;
                gap: 8px;
            }

            .enter-btn, .details-btn {
                width: 100%;
                padding: 12px;
                font-size: 1rem;
            }

            /* Mobile filter toggle */
            .mobile-filter-toggle {
                display: block;
                width: 100%;
                padding: 12px;
                background: var(--glass-bg);
                border: 1px solid var(--glass-border);
                border-radius: 12px;
                color: var(--text-primary);
                font-weight: 600;
                margin-bottom: 15px;
                backdrop-filter: blur(10px);
                cursor: pointer;
            }

            .mobile-sidebar {
                display: none;
                position: fixed;
                top: 200px; /* Account for header + ad banner */
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(20px);
                z-index: 1000;
                padding: 20px;
                overflow-y: auto;
            }

            .mobile-sidebar.show {
                display: block;
            }

            .mobile-sidebar-content {
                background: var(--glass-bg);
                border-radius: 20px;
                padding: 20px;
                border: 1px solid var(--glass-border);
                backdrop-filter: blur(10px);
            }

            .mobile-sidebar-close {
                position: absolute;
                top: 20px;
                right: 20px;
                background: none;
                border: none;
                color: var(--text-primary);
                font-size: 24px;
                cursor: pointer;
                z-index: 1001;
            }
        }

        @media (max-width: 480px) {
            .logo-section h1 {
                font-size: 1.6rem;
            }

            .header-actions {
                flex-direction: column;
                width: 100%;
            }

            .action-btn {
                width: 100%;
                justify-content: center;
            }

            .stats-bar {
                grid-template-columns: 1fr;
            }

            .marketplace-container {
                margin-top: 240px;
                padding: 0 8px;
            }

            .raffle-card {
                padding: 15px;
            }

            .raffle-image {
                height: 160px;
            }
        }

        /* Advertisement Banner Styles */
        .ad-banner-container {
            position: relative;
            width: 100%;
            height: 80px;
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.1), rgba(153, 69, 255, 0.1));
            border-bottom: 1px solid var(--glass-border);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .ad-banner {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 0 20px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ad-banner:hover {
            background: rgba(20, 241, 149, 0.05);
        }

        .ad-content {
            display: flex;
            align-items: center;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }

        .ad-logo {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            object-fit: cover;
            border: 2px solid var(--primary-green);
        }

        .ad-text {
            flex: 1;
            text-align: center;
        }

        .ad-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .ad-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .ad-sponsored {
            font-size: 0.8rem;
            color: var(--primary-green);
            font-weight: 600;
            background: rgba(20, 241, 149, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            border: 1px solid rgba(20, 241, 149, 0.3);
        }

        .ad-controls {
            position: absolute;
            bottom: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
        }

        .ad-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ad-dot.active {
            background: var(--primary-green);
            transform: scale(1.2);
        }

        .ad-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 2px;
            background: var(--primary-green);
            transition: width linear;
        }

        /* Admin Controls Styles */
        .admin-controls {
            background: linear-gradient(135deg, rgba(255, 69, 0, 0.1), rgba(255, 140, 0, 0.1));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            position: relative;
        }

        .admin-panel h3 {
            color: #ff8c00;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-btn {
            background: linear-gradient(135deg, #ff4500, #ff8c00);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.3);
        }

        .admin-btn-small {
            background: linear-gradient(135deg, #ff4500, #ff8c00);
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn-cancel {
            background: linear-gradient(135deg, #666, #888);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .admin-duration-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 140, 0, 0.1);
            border-radius: 8px;
        }

        .admin-duration-control label {
            color: var(--text-primary);
            font-weight: 600;
        }

        .admin-duration-control input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 6px;
            padding: 5px 10px;
            color: var(--text-primary);
            width: 100px;
        }

        /* Admin Ad Form Styles */
        .admin-ad-form-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .admin-ad-form {
            background: var(--glass-bg);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .admin-ad-form h3 {
            color: #ff8c00;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .form-group input {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            border-color: #ff8c00;
            box-shadow: 0 0 10px rgba(255, 140, 0, 0.3);
        }

        .form-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        /* Status Message Styles */
        .status-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px 25px;
            color: var(--text-primary);
            font-weight: 600;
            z-index: 3000;
            backdrop-filter: blur(10px);
            display: none;
        }

        .status-message.success {
            border-color: #14f195;
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.1), rgba(20, 241, 149, 0.05));
        }

        .status-message.error {
            border-color: #ff4757;
            background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(255, 71, 87, 0.05));
        }

        .status-message.info {
            border-color: #3742fa;
            background: linear-gradient(135deg, rgba(55, 66, 250, 0.1), rgba(55, 66, 250, 0.05));
        }

        /* Mobile Filter Toggle Button */
        .mobile-filter-toggle {
            display: none;
        }

        @media (max-width: 1200px) {
            .mobile-filter-toggle {
                display: block;
            }
        }

        /* Search and Filters */
        .search-section {
            margin-bottom: 2rem;
        }

        .search-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1rem 1rem 1rem 3rem;
            color: var(--text-primary);
            font-size: 1rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(20, 241, 149, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .filter-chip {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-chip:hover, .filter-chip.active {
            background: linear-gradient(135deg, rgba(20, 241, 149, 0.1), rgba(153, 69, 255, 0.1));
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #14f195, #9945FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            color: #ccc;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            color: #14f195;
            background: rgba(20, 241, 149, 0.1);
        }

        .admin-link {
            background: linear-gradient(135deg, #14f195, #9945FF);
            color: #0a0a0a;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .admin-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(20, 241, 149, 0.3);
        }        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(45deg, #9945ff, #14f195);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #14f195;
        }

        .connect-btn {
            background: linear-gradient(45deg, #9945ff, #14f195);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(153, 69, 255, 0.3);
        }

        .connected {
            background: linear-gradient(45deg, #14f195, #14f195) !important;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            position: relative;
        }

        .hero-content h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, #ffffff, #14f195);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-content p {
            font-size: 1.3rem;
            margin-bottom: 3rem;
            color: #cccccc;
            max-width: 600px;
        }

        .hero-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            padding: 1rem 2rem;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, #9945ff, #14f195);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-primary:hover, .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(153, 69, 255, 0.4);
        }

        /* Live Giveaway Section */
        .live-giveaway {
            padding: 5rem 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            background: linear-gradient(45deg, #9945ff, #14f195);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .giveaway-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 2.5rem;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .urgency-banner {
            background: linear-gradient(45deg, #ff4757, #ff6b7a);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            font-weight: 600;
            animation: pulseFade 2s infinite;
        }

        @keyframes pulseFade {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .bmw-image {
            width: 100%;
            height: 250px;
            border-radius: 15px;
            object-fit: cover;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Video Support */
        .media-container {
            position: relative;
            width: 100%;
            margin-bottom: 1.5rem;
        }

        .raffle-video {
            width: 100%;
            height: 250px;
            border-radius: 15px;
            object-fit: cover;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .youtube-container {
            position: relative;
            width: 100%;
            height: 250px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .youtube-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 15px;
        }

        .media-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            cursor: pointer;
            z-index: 10;
        }

        .media-toggle:hover {
            background: rgba(0, 0, 0, 0.9);
        }        .giveaway-title {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            color: #ffffff;
        }

        .giveaway-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.08);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-label {
            color: #cccccc;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .detail-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #14f195;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 2rem 0 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #9945ff, #14f195);
            transition: width 0.5s ease;
        }

        .countdown {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .countdown-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.08);
            padding: 1rem;
            border-radius: 10px;
            min-width: 80px;
        }

        .countdown-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #14f195;
        }

        .countdown-label {
            font-size: 0.8rem;
            color: #cccccc;
            margin-top: 0.5rem;
        }

        /* Wallet Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            margin: 15% auto;
            padding: 2rem;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: #fff;
        }

        .wallet-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            margin: 1rem 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .wallet-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .wallet-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
        }

        .status-message {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            z-index: 1500;
            max-width: 300px;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .status-message.show {
            opacity: 1;
            transform: translateX(0);
        }

        .status-success {
            background: linear-gradient(45deg, #14f195, #00d2ff);
            color: white;
        }

        .status-error {
            background: linear-gradient(45deg, #ff4757, #ff6b7a);
            color: white;
        }

        .status-info {
            background: linear-gradient(45deg, #9945ff, #14f195);
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .giveaway-details {
                grid-template-columns: 1fr 1fr;
            }
            
            .countdown {
                flex-wrap: wrap;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Glass Dark Background -->
    <div class="mesh-background"></div>
    <div class="particles-overlay">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 1.5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 2.5s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 3.5s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 0.5s;"></div>
    </div>

    <!-- Glass Header -->
    <header class="glass-header" id="header">
        <div class="logo-section">
            <div class="logo-icon">⚡</div>
            <div class="logo-text">GiveFi</div>
        </div>
        
        <nav class="nav-links">
            <a href="#marketplace" class="nav-link active">Marketplace</a>
            <a href="#trending" class="nav-link">Trending</a>
            <a href="#dao" class="nav-link">DAO</a>
            <a href="#analytics" class="nav-link">Analytics</a>
            <a href="admin.html" class="nav-link">Admin</a>
        </nav>

        <button class="wallet-connect" id="walletBtn" onclick="connectWallet()">
            <i class="fas fa-wallet"></i>
            <span>Connect Wallet</span>
        </button>
    </header>

    <!-- Advertisement Banner -->
    <div class="ad-banner-container" id="adBannerContainer">
        <div class="ad-banner" id="adBanner" onclick="openAdLink()">
            <div class="ad-content">
                <img class="ad-logo" id="adLogo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8cGF0aCBkPSJNMjUgMTBMMzUgMzBIMTVMMjUgMTBaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjUwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzE0RjE5NSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5OTQ1RkYiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K" alt="Ad Logo">
                <div class="ad-text">
                    <div class="ad-title" id="adTitle">Sample Advertisement</div>
                    <div class="ad-description" id="adDescription">This is a sample ad paid for with $GIVE tokens</div>
                </div>
                <div class="ad-sponsored">Sponsored</div>
            </div>
            <div class="ad-timer" id="adTimer"></div>
        </div>
        <div class="ad-controls" id="adControls">
            <div class="ad-dot active" data-ad="0"></div>
            <div class="ad-dot" data-ad="1"></div>
            <div class="ad-dot" data-ad="2"></div>
            <div class="ad-dot" data-ad="3"></div>
            <div class="ad-dot" data-ad="4"></div>
        </div>
    </div>

    <!-- Main Marketplace Container -->
    <main class="main-container">
        <!-- Marketplace Grid Layout -->
        <div class="marketplace-grid">
            <!-- Left Sidebar - Filters -->
            <aside class="sidebar">
                <!-- Search Section -->
                <div class="glass-card search-section">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" placeholder="Search raffles..." id="searchInput">
                    </div>
                    <div class="filter-chips">
                        <div class="filter-chip active" data-filter="all">All</div>
                        <div class="filter-chip" data-filter="live">Live</div>
                        <div class="filter-chip" data-filter="ending">Ending Soon</div>
                        <div class="filter-chip" data-filter="featured">Featured</div>
                    </div>
                </div>

                <!-- Price Range Filter -->
                <div class="glass-card filter-section">
                    <div class="filter-title">
                        <i class="fas fa-coins"></i>
                        Entry Fee Range
                    </div>
                    <div class="filter-option" data-price="all">
                        <span>All Prices</span>
                        <span class="text-muted">∞</span>
                    </div>
                    <div class="filter-option" data-price="low">
                        <span>0.01 - 0.1 SOL</span>
                        <span class="text-success">Low</span>
                    </div>
                    <div class="filter-option" data-price="mid">
                        <span>0.1 - 0.5 SOL</span>
                        <span class="text-warning">Mid</span>
                    </div>
                    <div class="filter-option" data-price="high">
                        <span>0.5+ SOL</span>
                        <span class="text-danger">High</span>
                    </div>
                </div>

                <!-- Category Filter -->
                <div class="glass-card filter-section">
                    <div class="filter-title">
                        <i class="fas fa-tags"></i>
                        Categories
                    </div>
                    <div class="filter-option" data-category="all">
                        <span>All Categories</span>
                        <span class="text-muted">∞</span>
                    </div>
                    <div class="filter-option" data-category="automotive">
                        <span>🚗 Automotive</span>
                        <span class="text-info">12</span>
                    </div>
                    <div class="filter-option" data-category="electronics">
                        <span>📱 Electronics</span>
                        <span class="text-info">8</span>
                    </div>
                    <div class="filter-option" data-category="crypto">
                        <span>₿ Crypto</span>
                        <span class="text-info">15</span>
                    </div>
                    <div class="filter-option" data-category="luxury">
                        <span>💎 Luxury</span>
                        <span class="text-info">5</span>
                    </div>
                </div>

                <!-- DAO Status -->
                <div class="glass-card filter-section">
                    <div class="filter-title">
                        <i class="fas fa-users"></i>
                        DAO Status
                    </div>
                    <div style="text-align: center; padding: 1rem;">
                        <div class="stat-value" id="daoMembers">1,247</div>
                        <div class="stat-label">Active Members</div>
                        <div class="stat-change positive">+12% this week</div>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content">
                <!-- Mobile Filter Toggle -->
                <button class="mobile-filter-toggle" onclick="toggleMobileFilters()">
                    <i class="fas fa-filter"></i> Filters & Categories
                </button>

                <!-- Stats Bar -->
                <section class="stats-bar">
                    <div class="stat-card">
                        <div class="stat-value" id="totalRaffles">23</div>
                        <div class="stat-label">Active Raffles</div>
                        <div class="stat-change positive">+3 today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalParticipants">1,547</div>
                        <div class="stat-label">Total Participants</div>
                        <div class="stat-change positive">+127 today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalVolume">847.3</div>
                        <div class="stat-label">SOL Volume</div>
                        <div class="stat-change positive">+23.4 SOL</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="successRate">94.2%</div>
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-change positive">+2.1%</div>
                    </div>
                </section>

                <!-- Raffles Grid -->
                <section class="raffles-grid" id="rafflesContainer">
                    <!-- Sample Featured Raffle -->
                    <div class="raffle-card featured" onclick="openRaffleModal('bmw-640i')">
                        <div class="raffle-image" style="background: url('https://images.unsplash.com/photo-1555215695-3004980ad54e?w=600&h=300&fit=crop') center/cover;">
                            <div class="raffle-status live">🔴 LIVE</div>
                            <div class="raffle-overlay">
                                <div class="raffle-title">BMW 640i M Sport</div>
                            </div>
                        </div>
                        <div class="raffle-content">
                            <div class="raffle-price">$75,000 Value</div>
                            <div class="raffle-stats">
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">47/50</div>
                                    <div class="raffle-stat-label">Entries</div>
                                </div>
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">2h 34m</div>
                                    <div class="raffle-stat-label">Time Left</div>
                                </div>
                            </div>
                            <div class="raffle-progress">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="font-size: 0.9rem; color: var(--text-secondary);">Progress</span>
                                    <span style="font-size: 0.9rem; color: var(--primary-green);">94%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 94%;"></div>
                                </div>
                            </div>
                            <div class="raffle-actions">
                                <button class="btn-primary">Enter for 0.1 SOL</button>
                                <button class="btn-secondary"><i class="fas fa-heart"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Sample Regular Raffle -->
                    <div class="raffle-card" onclick="openRaffleModal('iphone-15')">
                        <div class="raffle-image" style="background: url('https://images.unsplash.com/photo-1592078615290-033ee584e267?w=600&h=300&fit=crop') center/cover;">
                            <div class="raffle-status live">🔴 LIVE</div>
                            <div class="raffle-overlay">
                                <div class="raffle-title">iPhone 15 Pro Max</div>
                            </div>
                        </div>
                        <div class="raffle-content">
                            <div class="raffle-price">$1,299 Value</div>
                            <div class="raffle-stats">
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">89/100</div>
                                    <div class="raffle-stat-label">Entries</div>
                                </div>
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">5h 12m</div>
                                    <div class="raffle-stat-label">Time Left</div>
                                </div>
                            </div>
                            <div class="raffle-progress">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="font-size: 0.9rem; color: var(--text-secondary);">Progress</span>
                                    <span style="font-size: 0.9rem; color: var(--primary-green);">89%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 89%;"></div>
                                </div>
                            </div>
                            <div class="raffle-actions">
                                <button class="btn-primary">Enter for 0.05 SOL</button>
                                <button class="btn-secondary"><i class="fas fa-heart"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Sample Ending Soon Raffle -->
                    <div class="raffle-card" onclick="openRaffleModal('rolex-gmt')">
                        <div class="raffle-image" style="background: url('https://images.unsplash.com/photo-1523170335258-f5c6c6bd6eaf?w=600&h=300&fit=crop') center/cover;">
                            <div class="raffle-status ending">⏰ ENDING SOON</div>
                            <div class="raffle-overlay">
                                <div class="raffle-title">Rolex GMT Master II</div>
                            </div>
                        </div>
                        <div class="raffle-content">
                            <div class="raffle-price">$15,000 Value</div>
                            <div class="raffle-stats">
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">48/50</div>
                                    <div class="raffle-stat-label">Entries</div>
                                </div>
                                <div class="raffle-stat">
                                    <div class="raffle-stat-value">23m</div>
                                    <div class="raffle-stat-label">Time Left</div>
                                </div>
                            </div>
                            <div class="raffle-progress">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="font-size: 0.9rem; color: var(--text-secondary);">Progress</span>
                                    <span style="font-size: 0.9rem; color: var(--primary-green);">96%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 96%;"></div>
                                </div>
                            </div>
                            <div class="raffle-actions">
                                <button class="btn-primary">Enter for 0.2 SOL</button>
                                <button class="btn-secondary"><i class="fas fa-heart"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Loading skeleton cards for dynamic content -->
                    <div class="raffle-card skeleton" style="height: 400px; display: none;" id="loadingSkeleton1"></div>
                    <div class="raffle-card skeleton" style="height: 400px; display: none;" id="loadingSkeleton2"></div>
                </section>
            </main>

            <!-- Right Sidebar - Live Data & Analytics -->
            <aside class="right-sidebar">
                <!-- Live Activity Feed -->
                <div class="live-data-card">
                    <div class="live-data-header">
                        <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600;">Live Activity</h3>
                        <div class="live-indicator">
                            <div class="pulse-dot"></div>
                            <span>LIVE</span>
                        </div>
                    </div>
                    
                    <div class="activity-feed" id="activityFeed">
                        <div class="activity-item">
                            <div class="activity-icon">🎉</div>
                            <div class="activity-content">
                                <div class="activity-title">New entry: BMW 640i</div>
                                <div class="activity-time">2 minutes ago</div>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon">🏆</div>
                            <div class="activity-content">
                                <div class="activity-title">Winner selected: Tesla Model 3</div>
                                <div class="activity-time">5 minutes ago</div>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon">🚀</div>
                            <div class="activity-content">
                                <div class="activity-title">New raffle: MacBook Pro</div>
                                <div class="activity-time">12 minutes ago</div>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon">💎</div>
                            <div class="activity-content">
                                <div class="activity-title">Raffle funded: $50K Cash</div>
                                <div class="activity-time">18 minutes ago</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trending Raffles -->
                <div class="live-data-card trending-card">
                    <div class="live-data-header">
                        <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600;">Trending Today</h3>
                        <div style="color: var(--primary-green); font-size: 0.9rem; font-weight: 600;">🔥 HOT</div>
                    </div>
                    
                    <div class="trending-list">
                        <div class="trending-item">
                            <div class="trending-info">
                                <div class="trending-rank">1</div>
                                <div class="trending-details">
                                    <h4>BMW 640i M Sport</h4>
                                    <p>94% filled • 2h left</p>
                                </div>
                            </div>
                            <div class="trending-value">
                                <div class="trending-price">0.1 SOL</div>
                                <div class="trending-change positive">+47 entries</div>
                            </div>
                        </div>
                        
                        <div class="trending-item">
                            <div class="trending-info">
                                <div class="trending-rank">2</div>
                                <div class="trending-details">
                                    <h4>iPhone 15 Pro</h4>
                                    <p>89% filled • 5h left</p>
                                </div>
                            </div>
                            <div class="trending-value">
                                <div class="trending-price">0.05 SOL</div>
                                <div class="trending-change positive">+89 entries</div>
                            </div>
                        </div>
                        
                        <div class="trending-item">
                            <div class="trending-info">
                                <div class="trending-rank">3</div>
                                <div class="trending-details">
                                    <h4>Rolex GMT</h4>
                                    <p>96% filled • 23m left</p>
                                </div>
                            </div>
                            <div class="trending-value">
                                <div class="trending-price">0.2 SOL</div>
                                <div class="trending-change positive">+48 entries</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Market Stats -->
                <div class="live-data-card">
                    <div class="live-data-header">
                        <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600;">Market Stats</h3>
                        <div style="color: var(--text-muted); font-size: 0.9rem;">24H</div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div style="text-align: center;">
                            <div class="stat-value" style="font-size: 1.4rem;">23.4K</div>
                            <div class="stat-label">Total Volume</div>
                            <div class="stat-change positive" style="font-size: 0.8rem;">+12.5%</div>
                        </div>
                        <div style="text-align: center;">
                            <div class="stat-value" style="font-size: 1.4rem;">156</div>
                            <div class="stat-label">Active Users</div>
                            <div class="stat-change positive" style="font-size: 0.8rem;">+8.3%</div>
                        </div>
                        <div style="text-align: center;">
                            <div class="stat-value" style="font-size: 1.4rem;">847</div>
                            <div class="stat-label">SOL Staked</div>
                            <div class="stat-change positive" style="font-size: 0.8rem;">+23.4</div>
                        </div>
                        <div style="text-align: center;">
                            <div class="stat-value" style="font-size: 1.4rem;">94.2%</div>
                            <div class="stat-label">Win Rate</div>
                            <div class="stat-change positive" style="font-size: 0.8rem;">+2.1%</div>
                        </div>
                    </div>
                </div>

                <!-- $GIVE Token Stats -->
                <div class="live-data-card" style="background: linear-gradient(135deg, rgba(20, 241, 149, 0.1), rgba(153, 69, 255, 0.1)); border: 1px solid var(--primary-green);">
                    <div class="live-data-header">
                        <h3 style="color: var(--primary-green); font-size: 1.1rem; font-weight: 600;">$GIVE Token</h3>
                        <div style="color: var(--primary-green); font-size: 0.9rem; font-weight: 600;">ACTIVE</div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 1rem;">
                        <div class="stat-value" style="color: var(--primary-green); font-size: 1.6rem;">1,247</div>
                        <div class="stat-label">DAO Voters</div>
                        <div class="stat-change positive" style="font-size: 0.8rem;">+12% this week</div>
                        
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(20, 241, 149, 0.2);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="font-size: 0.9rem; color: var(--text-secondary);">Min. Stake</span>
                                <span style="font-size: 0.9rem; color: var(--primary-green);">1M $GIVE</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 0.9rem; color: var(--text-secondary);">Delegations</span>
                                <span style="font-size: 0.9rem; color: var(--primary-green);">156 active</span>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Mobile Sidebar Overlay -->
        <div class="mobile-sidebar" id="mobileSidebar">
            <button class="mobile-sidebar-close" onclick="toggleMobileFilters()">×</button>
            <div class="mobile-sidebar-content">
                <!-- Copy of left sidebar content for mobile -->
                <div class="filter-section">
                    <div class="filter-title">
                        <i class="fas fa-dollar-sign"></i>
                        Price Range
                    </div>
                    <div class="filter-option active" data-price="all" onclick="applyFilter('price', 'all')">
                        <span>All Prices</span>
                        <span class="text-muted">∞</span>
                    </div>
                    <div class="filter-option" data-price="low" onclick="applyFilter('price', 'low')">
                        <span>0.01 - 0.1 SOL</span>
                        <span class="text-success">Low</span>
                    </div>
                    <div class="filter-option" data-price="mid" onclick="applyFilter('price', 'mid')">
                        <span>0.1 - 0.5 SOL</span>
                        <span class="text-warning">Mid</span>
                    </div>
                    <div class="filter-option" data-price="high" onclick="applyFilter('price', 'high')">
                        <span>0.5+ SOL</span>
                        <span class="text-danger">High</span>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-title">
                        <i class="fas fa-clock"></i>
                        Status
                    </div>
                    <div class="filter-option active" data-status="all" onclick="applyFilter('status', 'all')">
                        <span>All Status</span>
                    </div>
                    <div class="filter-option" data-status="live" onclick="applyFilter('status', 'live')">
                        <span>Live Now</span>
                    </div>
                    <div class="filter-option" data-status="ending" onclick="applyFilter('status', 'ending')">
                        <span>Ending Soon</span>
                    </div>
                </div>

                <!-- Mobile Live Activity Feed -->
                <div class="live-data-card">
                    <div class="live-data-header">
                        <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600;">Live Activity</h3>
                        <div class="live-indicator">
                            <div class="pulse-dot"></div>
                            <span>LIVE</span>
                        </div>
                    </div>
                    
                    <div class="activity-feed" id="mobileActivityFeed">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </main>
            <h1>Transparent Giveaways on Solana</h1>
            <p>The first provably fair giveaway platform. Every entry verified on-chain. No more wondering if it's rigged.</p>
            <div class="hero-buttons">
                <button class="btn-primary" onclick="scrollToGiveaway()">Enter BMW Giveaway</button>
                <a href="#how-it-works" class="btn-secondary">How It Works</a>
            </div>
        </div>
    </section>

    <!-- Live Giveaway Section -->
    <section id="giveaways" class="live-giveaway">
        <h2 class="section-title">🔥 Live Giveaway</h2>
        
        <div class="giveaway-card">
            <div class="urgency-banner" id="urgencyBanner">
                ⚡ URGENT: Loading participant count...
            </div>
            
            <!-- Media Container - supports images, videos, and YouTube -->
            <div class="media-container" id="mediaContainer">
                <!-- Default BMW image -->
                <img src="https://images.unsplash.com/photo-1555215695-3004980ad54e?w=600&h=300&fit=crop" 
                     alt="BMW 640i M Sport" 
                     class="bmw-image" 
                     id="raffleImage"
                     style="display: block;">
                
                <!-- Video element (hidden by default) -->
                <video class="raffle-video" 
                       id="raffleVideo" 
                       controls 
                       preload="metadata"
                       style="display: none;">
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                
                <!-- YouTube container (hidden by default) -->
                <div class="youtube-container" id="youtubeContainer" style="display: none;">
                    <iframe id="youtubeFrame" 
                            src="" 
                            title="YouTube video player" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen>
                    </iframe>
                </div>
                
                <!-- Media toggle button -->
                <button class="media-toggle" id="mediaToggle" onclick="toggleMedia()" style="display: none;">
                    📺 View Video
                </button>
            </div>
            
            <h3 class="giveaway-title">BMW 640i M Sport</h3>
            <p style="color: #ccc; font-size: 1.1rem; margin-bottom: 2rem;">
                Luxury sports coupe worth $70,000+ • Winner's choice: Take the BMW or 33% cash jackpot
            </p>

            <div class="giveaway-details">
                <div class="detail-item">
                    <div class="detail-label">Entry Cost</div>
                    <div class="detail-value" id="entryFee">0.1 SOL</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Participants</div>
                    <div class="detail-value" id="participantCount">Loading...</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Prize Value</div>
                    <div class="detail-value">$70,000+</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Cash Option</div>
                    <div class="detail-value" id="cashOption">~3.3 SOL</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <p id="progressText" style="color: #14f195; font-weight: 600; margin-bottom: 2rem;">
                Loading raffle data...
            </p>

            <div class="countdown">
                <div class="countdown-item">
                    <div class="countdown-number" id="days">--</div>
                    <div class="countdown-label">Days</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="hours">--</div>
                    <div class="countdown-label">Hours</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="minutes">--</div>
                    <div class="countdown-label">Minutes</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="seconds">--</div>
                    <div class="countdown-label">Seconds</div>
                </div>
            </div>

            <p style="color: #ff6b7a; font-weight: 600; margin-bottom: 2rem;">
                ⚠️ Early-end enabled: Closes immediately when 50th person enters!
            </p>

            <button class="btn-primary" id="enterBtn" onclick="enterGiveaway()" style="font-size: 1.2rem; padding: 1.2rem 2.5rem;">
                Enter Now - 0.1 SOL
            </button>
        </div>
    </section>

    <!-- Wallet Selection Modal -->
    <div id="walletModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeWalletModal()">&times;</span>
            <h2 style="margin-bottom: 1.5rem; color: #fff;">Select Wallet</h2>
            <div id="walletList">
                <!-- Wallets will be populated by JavaScript -->
            </div>
            <p style="color: #ccc; font-size: 0.9rem; margin-top: 1rem; text-align: center;">
                Don't have a wallet? <a href="https://phantom.app/" target="_blank" style="color: #14f195;">Install Phantom</a>
            </p>
        </div>
    </div>

    <!-- Status Message -->
    <div id="statusMessage" class="status-message"></div>

    <script>
        // Embedded Solana Web3.js functionality
        const { Connection, PublicKey, Transaction, SystemProgram, LAMPORTS_PER_SOL } = window.solanaWeb3;
        
        // Smart Contract Configuration
        const PROGRAM_ID = '48mihemhp1UxYjz1UznH4fJ9FnF3AfN3XG18GasPFamU';
        const connection = new Connection('https://api.mainnet-beta.solana.com', 'confirmed');
        
        // Admin Configuration
        const ADMIN_WALLET_ADDRESS = '5YMBWHdvqpcKy2Ae6tmhFe81rGb8gHkkkRVpkdWQiV7T'; // Your admin wallet address
        // Example: const ADMIN_WALLET_ADDRESS = '7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU';
        let currentWallet = null;
        let isAdminConnected = false;

        // Marketplace State
        let marketplaceState = {
            totalVolume: 23400,
            activeUsers: 156,
            solStaked: 847,
            winRate: 94.2,
            activeRaffles: 42,
            totalPrizeValue: 156200
        };

        // Advertisement System
        class AdvertisementManager {
            constructor() {
                this.currentAdIndex = 0;
                this.adInterval = null;
                this.adDuration = 10000; // 10 seconds per ad (can be set by DAO)
                this.advertisements = [
                    {
                        id: 1,
                        title: "DeFi Trading Platform",
                        description: "Trade with 0% fees - Powered by Solana",
                        logo: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8cGF0aCBkPSJNMjUgMTBMMzUgMzBIMTVMMjUgMTBaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjUwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzE0RjE5NSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5OTQ1RkYiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",
                        link: "https://example-defi.com",
                        giveAmountPaid: 50000, // 50K $GIVE tokens
                        duration: 10000,
                        active: true
                    },
                    {
                        id: 2,
                        title: "NFT Marketplace",
                        description: "Mint, trade & earn - The future of digital art",
                        logo: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8cGF0aCBkPSJNMTUgMTVIMzVWMzVIMTVWMTVaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjUwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzE0RjE5NSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5OTQ1RkYiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",
                        link: "https://example-nft.com",
                        giveAmountPaid: 75000,
                        duration: 15000,
                        active: true
                    },
                    {
                        id: 3,
                        title: "Solana Validator",
                        description: "Stake your SOL with 8.5% APY",
                        logo: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIxMCIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZGllbnQwIiB4MT0iMCIgeTE9IjAiIHgyPSI1MCIgeTI9IjUwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiMxNEYxOTUiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjOTk0NUZGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==",
                        link: "https://example-validator.com",
                        giveAmountPaid: 30000,
                        duration: 8000,
                        active: true
                    },
                    {
                        id: 4,
                        title: "Web3 Gaming",
                        description: "Play to earn in the metaverse",
                        logo: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8cGF0aCBkPSJNMTAgMjBMMjUgMTBMNDAgMjBWMzBMMjUgNDBMMTAgMzBWMjBaIiBmaWxsPSJ3aGl0ZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjUwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzE0RjE5NSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5OTQ1RkYiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",
                        link: "https://example-gaming.com",
                        giveAmountPaid: 100000,
                        duration: 12000,
                        active: true
                    },
                    {
                        id: 5,
                        title: "DeFi Lending Protocol",
                        description: "Lend & borrow with competitive rates",
                        logo: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8cGF0aCBkPSJNMTUgMjVIMzVNMjUgMTVWMzUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MCIgeDE9IjAiIHkxPSIwIiB4Mj0iNTAiIHkyPSI1MCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjMTRGMTk1Ii8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk5NDVGRiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=",
                        link: "https://example-lending.com",
                        giveAmountPaid: 60000,
                        duration: 11000,
                        active: true
                    }
                ];
                this.currentAd = this.advertisements[0];
            }

            start() {
                this.updateAdDisplay();
                this.startRotation();
            }

            startRotation() {
                if (this.adInterval) clearInterval(this.adInterval);
                
                this.adInterval = setInterval(() => {
                    this.nextAd();
                }, this.currentAd.duration || this.adDuration);

                // Start timer animation
                this.startTimerAnimation();
            }

            nextAd() {
                this.currentAdIndex = (this.currentAdIndex + 1) % this.advertisements.length;
                this.currentAd = this.advertisements[this.currentAdIndex];
                this.updateAdDisplay();
                this.updateAdControls();
                this.startRotation(); // Restart with new ad's duration
            }

            updateAdDisplay() {
                const titleEl = document.getElementById('adTitle');
                const descEl = document.getElementById('adDescription');
                const logoEl = document.getElementById('adLogo');

                if (titleEl) titleEl.textContent = this.currentAd.title;
                if (descEl) descEl.textContent = this.currentAd.description;
                if (logoEl) logoEl.src = this.currentAd.logo;
            }

            updateAdControls() {
                const dots = document.querySelectorAll('.ad-dot');
                dots.forEach((dot, index) => {
                    if (index === this.currentAdIndex) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }

            startTimerAnimation() {
                const timer = document.getElementById('adTimer');
                if (timer) {
                    timer.style.width = '0%';
                    timer.style.transition = `width ${this.currentAd.duration || this.adDuration}ms linear`;
                    
                    setTimeout(() => {
                        timer.style.width = '100%';
                    }, 100);
                }
            }

            goToAd(index) {
                this.currentAdIndex = index;
                this.currentAd = this.advertisements[index];
                this.updateAdDisplay();
                this.updateAdControls();
                this.startRotation();
            }

            openCurrentAdLink() {
                if (this.currentAd.link) {
                    window.open(this.currentAd.link, '_blank');
                }
            }

            // DAO Functions for managing ads
            addAdvertisement(adData, isAdmin = false) {
                // Admin override check
                if (isAdmin && isAdminConnected) {
                    const adminAd = {
                        id: Date.now(),
                        title: adData.title,
                        description: adData.description,
                        logo: adData.logo,
                        link: adData.link,
                        giveAmountPaid: 0, // Admin ads are free
                        duration: adData.duration || this.adDuration,
                        active: true,
                        startTime: Date.now(),
                        endTime: Date.now() + (adData.totalDuration || 86400000), // 24 hours default
                        isAdminAd: true,
                        priority: 1 // Admin ads get priority
                    };
                    
                    // Insert admin ad at the beginning
                    this.advertisements.unshift(adminAd);
                    console.log(`Admin Advertisement added: ${adminAd.title} - FREE (Admin Override)`);
                    this.updateAdDisplay();
                    this.updateAdControls();
                    return true;
                }
                
                // Regular DAO process - Verify $GIVE payment and DAO approval
                if (!this.verifyGivePayment(adData.giveAmountPaid)) {
                    console.error('Insufficient $GIVE payment for advertisement');
                    return false;
                }
                
                const newAd = {
                    id: Date.now(),
                    title: adData.title,
                    description: adData.description,
                    logo: adData.logo,
                    link: adData.link,
                    giveAmountPaid: adData.giveAmountPaid,
                    duration: adData.duration || this.adDuration,
                    active: true,
                    startTime: Date.now(),
                    endTime: Date.now() + (adData.totalDuration || 86400000), // 24 hours default
                    isAdminAd: false,
                    priority: 0
                };
                
                this.advertisements.push(newAd);
                console.log(`Advertisement added: ${newAd.title} - Paid ${newAd.giveAmountPaid} $GIVE`);
                return true;
            }

            verifyGivePayment(amount) {
                // In production, this would verify the actual $GIVE token transfer
                // For now, we'll simulate the verification
                return amount >= 1000; // Minimum 1000 $GIVE tokens required
            }

            removeAdvertisement(adId, isAdmin = false) {
                // Admin can remove any ad, regular users can only remove their own
                if (isAdmin && isAdminConnected) {
                    this.advertisements = this.advertisements.filter(ad => ad.id !== adId);
                    console.log(`Admin removed advertisement: ${adId}`);
                } else {
                    // Regular users would need verification here
                    console.log('Only admin can remove advertisements');
                    return false;
                }
                
                if (this.currentAdIndex >= this.advertisements.length) {
                    this.currentAdIndex = 0;
                }
                this.currentAd = this.advertisements[this.currentAdIndex];
                this.updateAdDisplay();
                this.updateAdControls();
                return true;
            }

            // Admin function to pause/resume ads
            adminPauseAd(adId) {
                if (!isAdminConnected) {
                    console.error('Admin access required');
                    return false;
                }
                
                const ad = this.advertisements.find(a => a.id === adId);
                if (ad) {
                    ad.active = false;
                    console.log(`Admin paused advertisement: ${ad.title}`);
                    return true;
                }
                return false;
            }

            adminResumeAd(adId) {
                if (!isAdminConnected) {
                    console.error('Admin access required');
                    return false;
                }
                
                const ad = this.advertisements.find(a => a.id === adId);
                if (ad) {
                    ad.active = true;
                    console.log(`Admin resumed advertisement: ${ad.title}`);
                    return true;
                }
                return false;
            }

            // Admin function to change ad duration
            adminSetAdDuration(newDuration) {
                if (!isAdminConnected) {
                    console.error('Admin access required');
                    return false;
                }
                
                this.adDuration = newDuration;
                console.log(`Admin set ad duration to: ${newDuration}ms`);
                this.startRotation(); // Restart with new duration
                return true;
            }

            removeExpiredAds() {
                const now = Date.now();
                this.advertisements = this.advertisements.filter(ad => 
                    ad.active && ad.endTime > now
                );
            }

            pause() {
                if (this.adInterval) {
                    clearInterval(this.adInterval);
                    this.adInterval = null;
                }
            }

            resume() {
                this.startRotation();
            }
        }

        // Mobile Functions
        function toggleMobileFilters() {
            const mobileSidebar = document.getElementById('mobileSidebar');
            if (mobileSidebar) {
                mobileSidebar.classList.toggle('show');
            }
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Advertisement Manager
            if (typeof AdvertisementManager !== 'undefined') {
                window.adManager = new AdvertisementManager();
                initializeAdControls();
            }
            
            // Check for auto-connect wallet
            checkAutoConnectWallet();
            
            // Other initializations...
            if (typeof connectWallet === 'function') {
                // Wallet initialization if needed
            }
        });

        async function checkAutoConnectWallet() {
            try {
                const { solana } = window;
                if (solana && solana.isConnected) {
                    currentWallet = solana.publicKey.toString();
                    checkAdminStatus(currentWallet);
                    updateWalletDisplay();
                }
            } catch (error) {
                console.log('No auto-connect available');
            }
        }

        // Advertisement Functions
        function openAdLink() {
            if (window.adManager) {
                window.adManager.openCurrentAdLink();
            }
        }

        // Add click handlers for ad control dots
        function initializeAdControls() {
            const dots = document.querySelectorAll('.ad-dot');
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    window.adManager.goToAd(index);
                });
            });
        }

        // Admin Advertisement Functions
        function showAdminAdForm() {
            if (!isAdminConnected) {
                showStatusMessage('Admin access required', 'error');
                return;
            }

            const form = document.createElement('div');
            form.id = 'adminAdForm';
            form.className = 'admin-ad-form-overlay';
            form.innerHTML = `
                <div class="admin-ad-form">
                    <h3>Add Admin Advertisement (FREE)</h3>
                    <form onsubmit="submitAdminAd(event)">
                        <div class="form-group">
                            <label>Title:</label>
                            <input type="text" id="adminAdTitle" required maxlength="50">
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <input type="text" id="adminAdDescription" required maxlength="100">
                        </div>
                        <div class="form-group">
                            <label>Link URL:</label>
                            <input type="url" id="adminAdLink" required>
                        </div>
                        <div class="form-group">
                            <label>Logo URL (optional):</label>
                            <input type="url" id="adminAdLogo">
                        </div>
                        <div class="form-group">
                            <label>Duration (hours):</label>
                            <input type="number" id="adminAdDuration" value="24" min="1" max="168">
                        </div>
                        <div class="form-buttons">
                            <button type="submit" class="admin-btn">Add Advertisement</button>
                            <button type="button" onclick="closeAdminAdForm()" class="admin-btn-cancel">Cancel</button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(form);
        }

        function submitAdminAd(event) {
            event.preventDefault();
            
            if (!isAdminConnected) {
                showStatusMessage('Admin access required', 'error');
                return;
            }

            const adData = {
                title: document.getElementById('adminAdTitle').value,
                description: document.getElementById('adminAdDescription').value,
                link: document.getElementById('adminAdLink').value,
                logo: document.getElementById('adminAdLogo').value || getDefaultAdLogo(),
                totalDuration: parseInt(document.getElementById('adminAdDuration').value) * 3600000 // Convert hours to ms
            };

            const success = window.adManager.addAdvertisement(adData, true); // true = admin override
            
            if (success) {
                showStatusMessage('Admin advertisement added successfully!', 'success');
                closeAdminAdForm();
            } else {
                showStatusMessage('Failed to add advertisement', 'error');
            }
        }

        function closeAdminAdForm() {
            const form = document.getElementById('adminAdForm');
            if (form) {
                form.remove();
            }
        }

        function pauseAllAds() {
            if (!isAdminConnected) {
                showStatusMessage('Admin access required', 'error');
                return;
            }
            
            window.adManager.pause();
            showStatusMessage('All advertisements paused', 'success');
        }

        function resumeAllAds() {
            if (!isAdminConnected) {
                showStatusMessage('Admin access required', 'error');
                return;
            }
            
            window.adManager.resume();
            showStatusMessage('All advertisements resumed', 'success');
        }

        function updateAdDuration() {
            if (!isAdminConnected) {
                showStatusMessage('Admin access required', 'error');
                return;
            }
            
            const newDuration = parseInt(document.getElementById('adminDuration').value);
            window.adManager.adminSetAdDuration(newDuration);
            showStatusMessage(`Ad duration updated to ${newDuration}ms`, 'success');
        }

        function getDefaultAdLogo() {
            return "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8dGV4dCB4PSIyNSIgeT0iMzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkE8L3RleHQ+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MCIgeDE9IjAiIHkxPSIwIiB4Mj0iNTAiIHkyPSI1MCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjMTRGMTk1Ii8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk5NDVGRiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=";
        }

        function updateWalletDisplay() {
            const walletBtn = document.querySelector('.connect-wallet-btn');
            if (walletBtn && currentWallet) {
                const shortAddress = currentWallet.slice(0, 4) + '...' + currentWallet.slice(-4);
                walletBtn.textContent = shortAddress;
                
                if (isAdminConnected) {
                    walletBtn.style.background = 'linear-gradient(135deg, #ff4500, #ff8c00)';
                    walletBtn.title = 'Admin Wallet Connected';
                }
            }
        }

        function showStatusMessage(message, type = 'info') {
            const statusEl = document.getElementById('statusMessage');
            if (statusEl) {
                statusEl.textContent = message;
                statusEl.className = `status-message ${type}`;
                statusEl.style.display = 'block';
                
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 3000);
            }
        }

        // Wallet connection and admin detection
        async function connectWallet() {
            try {
                const { solana } = window;
                if (!solana) {
                    showStatusMessage('Please install Phantom wallet', 'error');
                    return null;
                }

                const response = await solana.connect();
                currentWallet = response.publicKey.toString();
                
                // Check if connected wallet is admin
                checkAdminStatus(currentWallet);
                
                showStatusMessage('Wallet connected successfully!', 'success');
                updateWalletDisplay();
                return response.publicKey;
            } catch (error) {
                console.error('Error connecting wallet:', error);
                showStatusMessage('Failed to connect wallet', 'error');
                return null;
            }
        }

        function checkAdminStatus(walletAddress) {
            isAdminConnected = (walletAddress === ADMIN_WALLET_ADDRESS);
            
            if (isAdminConnected) {
                console.log('🛡️ Admin wallet connected - Full privileges enabled');
                showStatusMessage('Admin mode activated', 'success');
                showAdminControls();
            } else {
                console.log('👤 Regular user connected');
                hideAdminControls();
            }
        }

        function showAdminControls() {
            // Show admin advertisement controls
            const adminControls = document.createElement('div');
            adminControls.id = 'adminControls';
            adminControls.className = 'admin-controls';
            adminControls.innerHTML = `
                <div class="admin-panel">
                    <h3>🛡️ Admin Advertisement Controls</h3>
                    <button onclick="showAdminAdForm()" class="admin-btn">Add Admin Ad (FREE)</button>
                    <button onclick="showAdManagement()" class="admin-btn">Manage Ads</button>
                    <button onclick="pauseAllAds()" class="admin-btn">Pause All Ads</button>
                    <button onclick="resumeAllAds()" class="admin-btn">Resume All Ads</button>
                    <div class="admin-duration-control">
                        <label>Ad Duration (ms):</label>
                        <input type="number" id="adminDuration" value="10000" min="1000" max="30000">
                        <button onclick="updateAdDuration()" class="admin-btn-small">Update</button>
                    </div>
                </div>
            `;
            
            // Insert admin controls after the header
            const header = document.getElementById('header');
            if (header && !document.getElementById('adminControls')) {
                header.insertAdjacentElement('afterend', adminControls);
            }
        }

        function hideAdminControls() {
            const adminControls = document.getElementById('adminControls');
            if (adminControls) {
                adminControls.remove();
            }
        }

        // Global state - wallet-based data
        let currentWalletData = {
            rafflesCreated: [],
            rafflesEntered: [],
            currentRaffle: null,
            userStats: {
                totalEntered: 0,
                totalWon: 0,
                totalSpent: 0
            }
        };

        // Real raffle state storage (in production, this would be from smart contract)
        let activeRaffles = new Map(); // Map of raffle_id -> raffle_data
        let raffleParticipants = new Map(); // Map of raffle_id -> Set of participant addresses

        // Activity Feed Management
        class ActivityFeed {
            constructor() {
                this.activities = [
                    { icon: '🎉', title: 'New entry: BMW 640i', time: '2 minutes ago' },
                    { icon: '🏆', title: 'Winner selected: Tesla Model 3', time: '5 minutes ago' },
                    { icon: '🚀', title: 'New raffle: MacBook Pro', time: '12 minutes ago' },
                    { icon: '💎', title: 'Raffle funded: $50K Cash', time: '18 minutes ago' }
                ];
                this.updateInterval = null;
            }

            start() {
                this.updateInterval = setInterval(() => {
                    this.addRandomActivity();
                    this.updateLiveStats();
                }, 15000); // Update every 15 seconds
            }

            addRandomActivity() {
                const activities = [
                    { icon: '🎯', title: `New entry: ${this.getRandomPrize()}`, time: 'Just now' },
                    { icon: '🎊', title: `Winner selected: ${this.getRandomPrize()}`, time: 'Just now' },
                    { icon: '🚀', title: `New raffle: ${this.getRandomPrize()}`, time: 'Just now' },
                    { icon: '💰', title: `High value entry: ${this.getRandomPrize()}`, time: 'Just now' }
                ];

                const newActivity = activities[Math.floor(Math.random() * activities.length)];
                this.activities.unshift(newActivity);
                
                // Keep only last 8 activities
                if (this.activities.length > 8) {
                    this.activities.pop();
                }

                this.updateActivityDisplay();
                this.updateTimeStamps();
            }

            getRandomPrize() {
                const prizes = ['BMW M3', 'iPhone 15 Pro', 'Rolex Submariner', 'MacBook Pro', 'Tesla Model Y', 'Louis Vuitton Bag', 'Gaming PC', '$10K Cash'];
                return prizes[Math.floor(Math.random() * prizes.length)];
            }

            updateActivityDisplay() {
                const feed = document.getElementById('activityFeed');
                if (!feed) return;

                feed.innerHTML = this.activities.map(activity => `
                    <div class="activity-item">
                        <div class="activity-icon">${activity.icon}</div>
                        <div class="activity-content">
                            <div class="activity-title">${activity.title}</div>
                            <div class="activity-time">${activity.time}</div>
                        </div>
                    </div>
                `).join('');
            }

            updateTimeStamps() {
                // Update all time stamps to be more realistic
                this.activities.forEach((activity, index) => {
                    if (index === 0) {
                        activity.time = 'Just now';
                    } else {
                        const minutes = (index * 3) + Math.floor(Math.random() * 5);
                        activity.time = `${minutes} minutes ago`;
                    }
                });
            }

            updateLiveStats() {
                // Simulate live market changes
                marketplaceState.totalVolume += Math.floor(Math.random() * 100);
                marketplaceState.activeUsers += Math.floor(Math.random() * 3) - 1;
                marketplaceState.solStaked += Math.random() * 10;
                
                // Update stats display
                this.updateStatsDisplay();
            }

            updateStatsDisplay() {
                const updateElement = (id, value, suffix = '') => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value + suffix;
                };

                updateElement('totalVolumeValue', (marketplaceState.totalVolume / 1000).toFixed(1), 'K');
                updateElement('activeUsersValue', marketplaceState.activeUsers);
                updateElement('solStakedValue', marketplaceState.solStaked.toFixed(0));
                updateElement('winRateValue', marketplaceState.winRate.toFixed(1), '%');
            }
        }

        // Initialize Activity Feed
        const activityFeed = new ActivityFeed();

        // Search and Filter Functions
        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const raffleCards = document.querySelectorAll('.raffle-card:not(.skeleton)');
            
            raffleCards.forEach(card => {
                const title = card.querySelector('.raffle-title')?.textContent?.toLowerCase() || '';
                const description = card.querySelector('.raffle-description')?.textContent?.toLowerCase() || '';
                
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function applyFilter(filterType, value) {
            // Update filter UI
            document.querySelectorAll('.filter-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');

            const raffleCards = document.querySelectorAll('.raffle-card:not(.skeleton)');
            
            raffleCards.forEach(card => {
                let show = true;
                
                switch(filterType) {
                    case 'status':
                        const status = card.querySelector('.raffle-status')?.textContent?.toLowerCase() || '';
                        if (value !== 'all' && !status.includes(value)) {
                            show = false;
                        }
                        break;
                    case 'price':
                        const price = parseFloat(card.querySelector('.raffle-price')?.textContent?.replace(/[^\d.]/g, '') || '0');
                        switch(value) {
                            case 'low':
                                show = price <= 0.1;
                                break;
                            case 'medium':
                                show = price > 0.1 && price <= 0.5;
                                break;
                            case 'high':
                                show = price > 0.5;
                                break;
                        }
                        break;
                    case 'time':
                        // This would need real time data in production
                        show = true;
                        break;
                }
                
                card.style.display = show ? 'block' : 'none';
            });
        }

        // Initialize search functionality
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', handleSearch);
            }

            // Start activity feed
            activityFeed.start();
            activityFeed.updateActivityDisplay();
            activityFeed.updateStatsDisplay();

            // Start advertisement system
            adManager.start();

            // Add ad control click handlers
            document.querySelectorAll('.ad-dot').forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    adManager.goToAd(index);
                });
            });

            // Sync mobile activity feed with main feed
            setInterval(() => {
                const mobileActivityFeed = document.getElementById('mobileActivityFeed');
                const mainActivityFeed = document.getElementById('activityFeed');
                if (mobileActivityFeed && mainActivityFeed) {
                    mobileActivityFeed.innerHTML = mainActivityFeed.innerHTML;
                }
            }, 1000);

            // Update stats bar with live data
            updateStatsBar();

            // Handle mobile orientation changes
            window.addEventListener('orientationchange', () => {
                setTimeout(() => {
                    // Close mobile sidebar on orientation change
                    const mobileSidebar = document.getElementById('mobileSidebar');
                    if (mobileSidebar) {
                        mobileSidebar.classList.remove('show');
                    }
                }, 100);
            });
        });

        // Update Stats Bar Function
        function updateStatsBar() {
            const statsData = [
                { 
                    id: 'totalVolumeValue',
                    label: 'Total Volume',
                    value: (marketplaceState.totalVolume / 1000).toFixed(1) + 'K SOL',
                    change: '+12.5%'
                },
                { 
                    id: 'activeUsersValue',
                    label: 'Active Users',
                    value: marketplaceState.activeUsers.toString(),
                    change: '+8.3%'
                },
                { 
                    id: 'solStakedValue',
                    label: 'SOL Staked',
                    value: marketplaceState.solStaked.toFixed(0),
                    change: '+23.4'
                },
                { 
                    id: 'winRateValue',
                    label: 'Win Rate',
                    value: marketplaceState.winRate.toFixed(1) + '%',
                    change: '+2.1%'
                },
                { 
                    id: 'activeRafflesValue',
                    label: 'Active Raffles',
                    value: marketplaceState.activeRaffles.toString(),
                    change: '+5'
                },
                { 
                    id: 'totalPrizeValue',
                    label: 'Total Prize Value',
                    value: '$' + (marketplaceState.totalPrizeValue / 1000).toFixed(0) + 'K',
                    change: '+18.7%'
                }
            ];

            // Update existing stats or create them
            const statsBar = document.querySelector('.stats-bar');
            if (statsBar) {
                statsBar.innerHTML = statsData.map(stat => `
                    <div class="stat-card">
                        <div class="stat-value" id="${stat.id}">${stat.value}</div>
                        <div class="stat-label">${stat.label}</div>
                        <div class="stat-change positive">${stat.change}</div>
                    </div>
                `).join('');
            }
        }

        // Wallet Manager Class
        class WalletManager {
            constructor() {
                this.wallet = null;
                this.connected = false;
                this.publicKey = null;
                this.walletName = null;
            }

            isWalletAvailable(walletName) {
                switch (walletName) {
                    case 'phantom':
                        return window.phantom?.solana?.isPhantom;
                    case 'solflare':
                        return window.solflare?.isSolflare;
                    case 'backpack':
                        return window.backpack?.isBackpack;
                    default:
                        return false;
                }
            }

            getAvailableWallets() {
                const wallets = [];
                
                if (this.isWalletAvailable('phantom')) {
                    wallets.push({
                        name: 'Phantom',
                        id: 'phantom',
                        icon: 'https://phantom.app/img/phantom-icon.svg'
                    });
                }
                
                if (this.isWalletAvailable('solflare')) {
                    wallets.push({
                        name: 'Solflare', 
                        id: 'solflare',
                        icon: 'https://solflare.com/img/logo.svg'
                    });
                }
                
                if (this.isWalletAvailable('backpack')) {
                    wallets.push({
                        name: 'Backpack',
                        id: 'backpack', 
                        icon: 'https://backpack.app/icon.png'
                    });
                }

                return wallets;
            }

            async connect(walletName) {
                try {
                    let provider;
                    
                    switch (walletName) {
                        case 'phantom':
                            if (!window.phantom?.solana) {
                                window.open('https://phantom.app/', '_blank');
                                throw new Error('Phantom wallet not found');
                            }
                            provider = window.phantom.solana;
                            break;
                            
                        case 'solflare':
                            if (!window.solflare) {
                                window.open('https://solflare.com/', '_blank');
                                throw new Error('Solflare wallet not found');
                            }
                            provider = window.solflare;
                            break;
                            
                        case 'backpack':
                            if (!window.backpack) {
                                window.open('https://backpack.app/', '_blank');
                                throw new Error('Backpack wallet not found');
                            }
                            provider = window.backpack;
                            break;
                            
                        default:
                            throw new Error('Unsupported wallet');
                    }

                    const response = await provider.connect();
                    
                    this.wallet = provider;
                    this.connected = true;
                    this.publicKey = response.publicKey;
                    this.walletName = walletName;

                    return {
                        success: true,
                        publicKey: response.publicKey.toString(),
                        walletName: walletName.charAt(0).toUpperCase() + walletName.slice(1)
                    };
                } catch (error) {
                    return {
                        success: false,
                        error: error.message
                    };
                }
            }

            async disconnect() {
                try {
                    if (this.wallet && this.wallet.disconnect) {
                        await this.wallet.disconnect();
                    }
                    
                    this.wallet = null;
                    this.connected = false;
                    this.publicKey = null;
                    this.walletName = null;

                    return { success: true };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }

            async autoConnect() {
                try {
                    if (window.phantom?.solana?.isConnected) {
                        const response = await window.phantom.solana.connect({ onlyIfTrusted: true });
                        this.wallet = window.phantom.solana;
                        this.connected = true;
                        this.publicKey = response.publicKey;
                        this.walletName = 'phantom';
                        
                        return {
                            success: true,
                            publicKey: response.publicKey.toString(),
                            walletName: 'Phantom'
                        };
                    }
                    return { success: false };
                } catch (error) {
                    return { success: false };
                }
            }

            formatPublicKey(pubkey) {
                const str = pubkey.toString();
                return `${str.slice(0, 4)}...${str.slice(-4)}`;
            }

            onWalletStateChange(callback) {
                this.onWalletChange = callback;
            }
        }

        // Initialize wallet manager
        const walletManager = new WalletManager();

        // Contract interaction functions
        async function enterRaffle() {
            if (!walletManager.connected) {
                showStatus('Please connect your wallet first', 'error');
                openWalletModal();
                return;
            }

            try {
                showStatus('Checking raffle eligibility...', 'info');
                
                // Get current active raffle
                const activeRafflesList = await queryActiveRaffles();
                if (activeRafflesList.length === 0) {
                    showStatus('No active raffles found', 'error');
                    return;
                }
                
                const currentRaffle = activeRafflesList[0];
                const userPublicKey = new PublicKey(walletManager.publicKey.toString());
                
                // Check if user already entered this raffle
                const hasEntered = await checkIfUserEntered(currentRaffle.raffleId, userPublicKey);
                if (hasEntered) {
                    showStatus('You have already entered this raffle!', 'error');
                    return;
                }
                
                // Check if raffle is full
                if (currentRaffle.currentParticipants >= currentRaffle.maxParticipants) {
                    showStatus('This raffle is full!', 'error');
                    return;
                }
                
                // Check if raffle has ended
                if (Date.now() > currentRaffle.endTime) {
                    showStatus('This raffle has ended!', 'error');
                    return;
                }
                
                // Get user's balance
                const balance = await connection.getBalance(userPublicKey);
                const entryFee = currentRaffle.entryFee * LAMPORTS_PER_SOL;
                const transactionFee = 5000; // 0.000005 SOL
                
                if (balance < entryFee + transactionFee) {
                    const needed = ((entryFee + transactionFee) / LAMPORTS_PER_SOL).toFixed(4);
                    showStatus(`Insufficient SOL balance. Need ${needed} SOL`, 'error');
                    return;
                }

                showStatus('Creating entry transaction...', 'info');
                
                // Create the enter raffle transaction
                const transaction = await createEnterRaffleTransaction(currentRaffle, userPublicKey);
                
                // Get recent blockhash
                const { blockhash } = await connection.getLatestBlockhash();
                transaction.recentBlockhash = blockhash;
                transaction.feePayer = userPublicKey;
                
                showStatus('Please approve the transaction in your wallet...', 'info');
                
                // Sign and send transaction
                const signedTransaction = await walletManager.wallet.signTransaction(transaction);
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());
                
                showStatus('Transaction sent! Confirming...', 'info');
                
                // Wait for confirmation
                const confirmation = await connection.confirmTransaction(signature, 'confirmed');
                
                if (confirmation.value.err) {
                    throw new Error('Transaction failed: ' + JSON.stringify(confirmation.value.err));
                }
                
                showStatus('Entry successful! Welcome to the raffle! 🎉', 'success');
                
                // Update local state
                currentWalletData.rafflesEntered.push({
                    raffleId: currentRaffle.raffleId,
                    timestamp: Date.now(),
                    entryFee: currentRaffle.entryFee,
                    signature: signature
                });
                
                // Refresh raffle data to show updated participant count
                await loadRaffleData();
                
            } catch (error) {
                console.error('Entry error:', error);
                if (error.message.includes('User rejected')) {
                    showStatus('Transaction cancelled by user', 'error');
                } else if (error.message.includes('insufficient')) {
                    showStatus('Insufficient SOL balance', 'error');
                } else {
                    showStatus('Failed to enter raffle: ' + error.message, 'error');
                }
            }
        }

        // Create enter raffle transaction
        async function createEnterRaffleTransaction(raffle, userPublicKey) {
            // Derive the raffle PDA
            const [rafflePDA] = PublicKey.findProgramAddressSync(
                [
                    Buffer.from('raffle'),
                    new PublicKey(raffle.creator).toBuffer(),
                    Buffer.from(raffle.raffleId.toString())
                ],
                new PublicKey(PROGRAM_ID)
            );
            
            // Derive user entry PDA
            const [userEntryPDA] = PublicKey.findProgramAddressSync(
                [
                    Buffer.from('entry'),
                    rafflePDA.toBuffer(),
                    userPublicKey.toBuffer()
                ],
                new PublicKey(PROGRAM_ID)
            );
            
            // Create instruction data for entering raffle
            const instructionData = Buffer.concat([
                Buffer.from([1]), // enter_raffle instruction discriminator
            ]);
            
            // Create the instruction
            const instruction = new TransactionInstruction({
                keys: [
                    { pubkey: userPublicKey, isSigner: true, isWritable: true },
                    { pubkey: rafflePDA, isSigner: false, isWritable: true },
                    { pubkey: userEntryPDA, isSigner: false, isWritable: true },
                    { pubkey: new PublicKey(raffle.treasury), isSigner: false, isWritable: true },
                    { pubkey: SystemProgram.programId, isSigner: false, isWritable: false },
                ],
                programId: new PublicKey(PROGRAM_ID),
                data: instructionData,
            });
            
            const transaction = new Transaction().add(instruction);
            return transaction;
        }

        // Check if user has already entered a raffle
        async function checkIfUserEntered(raffleId, userPublicKey) {
            try {
                // Check local storage first
                const localEntries = currentWalletData.rafflesEntered;
                const hasLocalEntry = localEntries.some(entry => entry.raffleId === raffleId);
                
                if (hasLocalEntry) return true;
                
                // Query blockchain for user entry account
                const raffleCreator = await getRaffleCreator(raffleId);
                const [rafflePDA] = PublicKey.findProgramAddressSync(
                    [
                        Buffer.from('raffle'),
                        raffleCreator.toBuffer(),
                        Buffer.from(raffleId.toString())
                    ],
                    new PublicKey(PROGRAM_ID)
                );
                
                const [userEntryPDA] = PublicKey.findProgramAddressSync(
                    [
                        Buffer.from('entry'),
                        rafflePDA.toBuffer(),
                        userPublicKey.toBuffer()
                    ],
                    new PublicKey(PROGRAM_ID)
                );
                
                const account = await connection.getAccountInfo(userEntryPDA);
                return account !== null;
                
            } catch (error) {
                console.log('Error checking user entry:', error);
                return false;
            }
        }

        // Get raffle creator from raffle ID (helper function)
        async function getRaffleCreator(raffleId) {
            // In a real implementation, you'd have a way to map raffle IDs to creators
            // For now, return a placeholder
            return new PublicKey('11111111111111111111111111111111');
        }

        // Global variables
        let currentRaffleHost = null;
        let raffleEndTime = null;

        // Media Management Functions
        
        // Toggle between different media types in the raffle display
        function toggleMedia() {
            const image = document.getElementById('raffleImage');
            const video = document.getElementById('raffleVideo');
            const youtube = document.getElementById('youtubeContainer');
            const toggleBtn = document.getElementById('mediaToggle');

            if (currentMediaType === 'image') {
                // If we have video or YouTube, show those instead
                if (video.src && video.style.display === 'none') {
                    image.style.display = 'none';
                    video.style.display = 'block';
                    youtube.style.display = 'none';
                    toggleBtn.textContent = '🖼️ View Image';
                } else if (youtube.querySelector('iframe').src && youtube.style.display === 'none') {
                    image.style.display = 'none';
                    video.style.display = 'none';
                    youtube.style.display = 'block';
                    toggleBtn.textContent = '🖼️ View Image';
                }
            } else {
                // Switch back to image
                image.style.display = 'block';
                video.style.display = 'none';
                youtube.style.display = 'none';
                toggleBtn.textContent = '📺 View Video';
            }
        }

        // Initialize the application
        async function initApp() {
            try {
                console.log('🚀 Initializing GiveFi DApp...');
                
                // Try to auto-connect wallet
                const autoConnect = await walletManager.autoConnect();
                if (autoConnect.success) {
                    updateWalletUI(autoConnect);
                    showStatus('Wallet auto-connected!', 'success');
                }

                // Load raffle data
                await loadRaffleData();
                
                // Start countdown timer
                startCountdown();
                
                // Populate wallet list
                populateWalletList();
                
                console.log('✅ App initialized successfully');
            } catch (error) {
                console.error('❌ Error initializing app:', error);
                showStatus('Error initializing application', 'error');
            }
        }

        // Load raffle data from smart contract
        async function loadRaffleData() {
            try {
                showStatus('Loading active raffles...', 'info');
                
                // Query all active raffles from the smart contract
                const activeRafflesList = await queryActiveRaffles();
                
                if (activeRafflesList.length === 0) {
                    // No active raffles
                    document.getElementById('giveaways').innerHTML = `
                        <div style="text-align: center; padding: 4rem 1rem; color: #ccc;">
                            <h2 style="font-size: 2rem; margin-bottom: 1rem;">🎰 No Active Raffles</h2>
                            <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                                Be the first to know when new exciting raffles go live!
                            </p>
                            <button class="btn-primary" onclick="notifyWhenLive()" style="padding: 1rem 2rem;">
                                🔔 Notify Me When Live
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Load the first active raffle (or most recent)
                const currentRaffle = activeRafflesList[0];
                updateRaffleUI(currentRaffle);
                
                console.log('✅ Loaded raffle data from smart contract');
                
            } catch (error) {
                console.error('Error loading raffle data:', error);
                showStatus('Error loading raffle data. Please refresh the page.', 'error');
                
                // Fallback to "coming soon" state
                document.getElementById('giveaways').innerHTML = `
                    <div style="text-align: center; padding: 4rem 1rem; color: #ccc;">
                        <h2 style="font-size: 2rem; margin-bottom: 1rem;">🔄 Loading Raffles...</h2>
                        <p style="font-size: 1.2rem;">
                            Connecting to Solana blockchain...
                        </p>
                    </div>
                `;
            }
        }

        // Query active raffles from smart contract
        async function queryActiveRaffles() {
            try {
                // In a real implementation, this would query your program accounts
                // For now, we'll return an empty array until raffles are created via admin panel
                
                // Query program accounts for active raffles
                const programAccounts = await connection.getProgramAccounts(
                    new PublicKey(PROGRAM_ID),
                    {
                        filters: [
                            {
                                dataSize: 200 // Approximate size of raffle account
                            }
                        ]
                    }
                );
                
                console.log(`Found ${programAccounts.length} raffle accounts`);
                
                // Parse and filter active raffles
                const activeRaffles = [];
                for (const account of programAccounts) {
                    try {
                        const raffleData = parseRaffleAccount(account.account.data);
                        if (raffleData && raffleData.isActive) {
                            activeRaffles.push(raffleData);
                        }
                    } catch (parseError) {
                        console.log('Skipping invalid raffle account:', parseError.message);
                    }
                }
                
                return activeRaffles.sort((a, b) => b.createdAt - a.createdAt);
                
            } catch (error) {
                console.error('Error querying raffles:', error);
                return [];
            }
        }

        // Parse raffle account data
        function parseRaffleAccount(data) {
            // This would implement the actual parsing of your Rust struct
            // For now, return null since we're waiting for real raffles to be created
            return null;
        }

        // Update raffle UI with data
        function updateRaffleUI(data) {
            document.getElementById('entryFee').textContent = `${data.entryFee} SOL`;
            document.getElementById('participantCount').textContent = `${data.currentParticipants}/${data.maxParticipants}`;
            document.getElementById('cashOption').textContent = `~${data.cashOption} SOL`;
            
            const progressPercent = (data.currentParticipants / data.maxParticipants) * 100;
            document.getElementById('progressFill').style.width = `${progressPercent}%`;
            
            const spotsLeft = data.maxParticipants - data.currentParticipants;
            document.getElementById('progressText').textContent = 
                `${Math.round(progressPercent)}% filled • Only ${spotsLeft} spots left!`;
                
            document.getElementById('urgencyBanner').textContent = 
                `⚡ URGENT: ${data.currentParticipants}/${data.maxParticipants} participants - Only ${spotsLeft} spots left!`;
            
            raffleEndTime = data.endTime;
        }

        // Update wallet UI and load user-specific data
        function updateWalletUI(walletState) {
            const connectBtn = document.getElementById('connectBtn');
            
            if (walletState.connected) {
                connectBtn.textContent = `Connected: ${walletManager.formatPublicKey(walletState.publicKey)}`;
                connectBtn.classList.add('connected');
                connectBtn.onclick = () => disconnectWallet();
                
                // Load user-specific data when wallet connects
                loadUserData(walletState.publicKey);
            } else {
                connectBtn.textContent = 'Connect Wallet';
                connectBtn.classList.remove('connected');
                connectBtn.onclick = () => openWalletModal();
                
                // Clear user data when wallet disconnects
                clearUserData();
            }
        }

        // Load user-specific data from blockchain
        async function loadUserData(publicKey) {
            try {
                showStatus('Loading your raffle history...', 'info');
                
                const userPubkey = new PublicKey(publicKey);
                
                // Reset user data
                currentWalletData = {
                    rafflesCreated: [],
                    rafflesEntered: [],
                    currentRaffle: null,
                    userStats: {
                        totalEntered: 0,
                        totalWon: 0,
                        totalSpent: 0
                    }
                };
                
                // Query user's raffle entries
                await loadUserRaffleEntries(userPubkey);
                
                // Query user's created raffles (if any)
                await loadUserCreatedRaffles(userPubkey);
                
                // Update UI with user stats
                updateUserStats();
                
                console.log('✅ User data loaded');
                
            } catch (error) {
                console.error('Error loading user data:', error);
                showStatus('Error loading your data', 'error');
            }
        }

        // Load user's raffle entries
        async function loadUserRaffleEntries(userPublicKey) {
            try {
                // Query all user entry accounts
                const entryAccounts = await connection.getProgramAccounts(
                    new PublicKey(PROGRAM_ID),
                    {
                        filters: [
                            {
                                memcmp: {
                                    offset: 8, // Skip discriminator
                                    bytes: userPublicKey.toBase58()
                                }
                            }
                        ]
                    }
                );
                
                for (const account of entryAccounts) {
                    try {
                        const entryData = parseUserEntryAccount(account.account.data);
                        if (entryData) {
                            currentWalletData.rafflesEntered.push(entryData);
                            currentWalletData.userStats.totalEntered++;
                            currentWalletData.userStats.totalSpent += entryData.entryFee;
                        }
                    } catch (parseError) {
                        console.log('Skipping invalid entry account:', parseError.message);
                    }
                }
                
            } catch (error) {
                console.error('Error loading user entries:', error);
            }
        }

        // Load user's created raffles
        async function loadUserCreatedRaffles(userPublicKey) {
            try {
                // Query raffles created by this user
                const raffleAccounts = await connection.getProgramAccounts(
                    new PublicKey(PROGRAM_ID),
                    {
                        filters: [
                            {
                                memcmp: {
                                    offset: 40, // Offset where creator pubkey is stored
                                    bytes: userPublicKey.toBase58()
                                }
                            }
                        ]
                    }
                );
                
                for (const account of raffleAccounts) {
                    try {
                        const raffleData = parseRaffleAccount(account.account.data);
                        if (raffleData && raffleData.creator === userPublicKey.toString()) {
                            currentWalletData.rafflesCreated.push(raffleData);
                        }
                    } catch (parseError) {
                        console.log('Skipping invalid raffle account:', parseError.message);
                    }
                }
                
            } catch (error) {
                console.error('Error loading user created raffles:', error);
            }
        }

        // Parse user entry account data
        function parseUserEntryAccount(data) {
            // This would implement the actual parsing of your Rust struct
            // For now, return null since we need real data structure
            return null;
        }

        // Update user stats display
        function updateUserStats() {
            // If we had a user stats section, we'd update it here
            // For now, we can add it to the status or create a user profile section
            if (currentWalletData.userStats.totalEntered > 0) {
                const statsMessage = `You've entered ${currentWalletData.userStats.totalEntered} raffles, spending ${currentWalletData.userStats.totalSpent.toFixed(3)} SOL`;
                console.log('📊 User stats:', statsMessage);
            }
        }

        // Clear user data when wallet disconnects
        function clearUserData() {
            currentWalletData = {
                rafflesCreated: [],
                rafflesEntered: [],
                currentRaffle: null,
                userStats: {
                    totalEntered: 0,
                    totalWon: 0,
                    totalSpent: 0
                }
            };
        }

        // Add function for users who want to be notified
        function notifyWhenLive() {
            if (!walletManager.connected) {
                showStatus('Please connect your wallet to get notifications', 'info');
                openWalletModal();
                return;
            }
            
            // In a real implementation, you'd store their wallet address for notifications
            showStatus('You\'ll be notified when new raffles go live! 🔔', 'success');
        }

        // Populate wallet list in modal
        function populateWalletList() {
            const walletList = document.getElementById('walletList');
            const availableWallets = walletManager.getAvailableWallets();
            
            walletList.innerHTML = '';
            
            if (availableWallets.length === 0) {
                walletList.innerHTML = `
                    <p style="color: #ccc; text-align: center; padding: 2rem;">
                        No Solana wallets detected. Please install a wallet like 
                        <a href="https://phantom.app/" target="_blank" style="color: #14f195;">Phantom</a> or 
                        <a href="https://solflare.com/" target="_blank" style="color: #14f195;">Solflare</a>.
                    </p>
                `;
                return;
            }
            
            availableWallets.forEach(wallet => {
                const walletOption = document.createElement('div');
                walletOption.className = 'wallet-option';
                walletOption.onclick = () => connectWallet(wallet.id);
                
                walletOption.innerHTML = `
                    <img src="${wallet.icon}" alt="${wallet.name}" class="wallet-icon">
                    <span>${wallet.name}</span>
                `;
                
                walletList.appendChild(walletOption);
            });
        }

        // Connect wallet
        async function connectWallet(walletId) {
            try {
                showStatus('Connecting to wallet...', 'info');
                
                const result = await walletManager.connect(walletId);
                
                if (result.success) {
                    updateWalletUI(result);
                    closeWalletModal();
                    showStatus(`Connected to ${result.walletName}!`, 'success');
                } else {
                    showStatus(result.error, 'error');
                }
                
            } catch (error) {
                console.error('Connection error:', error);
                showStatus('Failed to connect wallet', 'error');
            }
        }

        // Disconnect wallet
        async function disconnectWallet() {
            try {
                const result = await walletManager.disconnect();
                if (result.success) {
                    updateWalletUI({ connected: false, publicKey: null });
                    showStatus('Wallet disconnected', 'info');
                }
            } catch (error) {
                console.error('Disconnection error:', error);
                showStatus('Error disconnecting wallet', 'error');
            }
        }

        // Enter giveaway
        async function enterGiveaway() {
            const status = walletManager.getStatus();
            
            if (!status.connected) {
                openWalletModal();
                return;
            }

            try {
                const enterBtn = document.getElementById('enterBtn');
                enterBtn.disabled = true;
                enterBtn.textContent = 'Processing...';
                
                showStatus('Processing raffle entry...', 'info');

                // For demonstration, we'll simulate the transaction
                // In production, you'd call your smart contract here
                
                const mockTransaction = await simulateRaffleEntry();
                
                if (mockTransaction.success) {
                    showStatus('🎉 Entry successful! Good luck!', 'success');
                    enterBtn.textContent = 'Entered ✓';
                    enterBtn.style.background = 'linear-gradient(45deg, #14f195, #14f195)';
                    
                    // Update participant count
                    await loadRaffleData();
                } else {
                    throw new Error(mockTransaction.error);
                }
                
            } catch (error) {
                console.error('Entry error:', error);
                showStatus('Failed to enter raffle: ' + error.message, 'error');
                
                const enterBtn = document.getElementById('enterBtn');
                enterBtn.disabled = false;
                enterBtn.textContent = 'Enter Now - 0.1 SOL';
            }
        }

        // Simulate raffle entry (replace with actual contract call)
        async function simulateRaffleEntry() {
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simulate success with 90% probability
                    if (Math.random() > 0.1) {
                        resolve({ 
                            success: true,
                            signature: 'mock-signature-' + Math.random().toString(36).substring(7)
                        });
                    } else {
                        resolve({
                            success: false,
                            error: 'Insufficient SOL balance'
                        });
                    }
                }, 2000);
            });
        }

        // Show status message
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status-message status-${type} show`;
            
            setTimeout(() => {
                statusDiv.classList.remove('show');
            }, 5000);
        }

        // Start countdown timer
        function startCountdown() {
            setInterval(() => {
                if (!raffleEndTime) return;
                
                const now = Date.now();
                const timeLeft = raffleEndTime - now;
                
                if (timeLeft <= 0) {
                    document.getElementById('days').textContent = '0';
                    document.getElementById('hours').textContent = '0';
                    document.getElementById('minutes').textContent = '0';
                    document.getElementById('seconds').textContent = '0';
                    return;
                }
                
                const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days;
                document.getElementById('hours').textContent = hours;
                document.getElementById('minutes').textContent = minutes;
                document.getElementById('seconds').textContent = seconds;
            }, 1000);
        }

        // Modal functions
        window.openWalletModal = function() {
            document.getElementById('walletModal').style.display = 'block';
        };

        window.closeWalletModal = function() {
            document.getElementById('walletModal').style.display = 'none';
        };

        window.scrollToGiveaway = function() {
            document.getElementById('giveaways').scrollIntoView({ 
                behavior: 'smooth' 
            });
        };

        window.enterGiveaway = enterGiveaway;

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('walletModal');
            if (event.target === modal) {
                closeWalletModal();
            }
        };

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // Additional Marketplace Functions
        function showCreateModal() {
            // Show create raffle modal (to be implemented)
            showStatus('Create raffle functionality coming soon!', 'info');
        }

        function viewRaffleDetails(raffleId) {
            // Show detailed raffle view (to be implemented)
            showStatus('Raffle details view coming soon!', 'info');
        }

        function enterRaffle(raffleId, price) {
            if (!walletManager.connected) {
                showWalletModal();
                return;
            }
            
            // Simulate raffle entry
            showStatus(`Entering raffle for ${price} SOL...`, 'info');
            
            setTimeout(() => {
                showStatus('Successfully entered raffle!', 'success');
                
                // Update activity feed
                activityFeed.activities.unshift({
                    icon: '🎯',
                    title: 'You entered a raffle!',
                    time: 'Just now'
                });
                activityFeed.updateActivityDisplay();
            }, 2000);
        }

        // Auto-update marketplace data every 30 seconds
        setInterval(() => {
            if (typeof activityFeed !== 'undefined') {
                activityFeed.updateLiveStats();
            }
        }, 30000);

        // Mobile responsive menu toggle
        function toggleMobileMenu() {
            const leftSidebar = document.querySelector('.left-sidebar');
            const rightSidebar = document.querySelector('.right-sidebar');
            
            if (window.innerWidth <= 768) {
                if (leftSidebar.style.display === 'block') {
                    leftSidebar.style.display = 'none';
                    rightSidebar.style.display = 'none';
                } else {
                    leftSidebar.style.display = 'block';
                    rightSidebar.style.display = 'block';
                }
            }
        }

        // Handle window resize for responsive layout
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                const leftSidebar = document.querySelector('.left-sidebar');
                const rightSidebar = document.querySelector('.right-sidebar');
                leftSidebar.style.display = '';
                rightSidebar.style.display = '';
            }
        });
    </script>
</body>
</html>
